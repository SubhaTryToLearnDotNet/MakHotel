@using MakQR.Models.Home
@model HeaderSection

<div class="admin-page">

    <div class="hotel-form-card">
        <h3>Update Header</h3>
        <form id="HeaderForm"
              method="post"
              enctype="multipart/form-data">

            <div class="mb-3">
                <label>Hotel Title</label>
                <input asp-for="Title" class="form-control">
            </div>
            <div class="mb-3">
                <label>Description</label>
                <input asp-for="Description" class="form-control">

            </div>

            <button type="submit" class="btn btn-success"> Save </button>
        </form>


    </div>

</div>



<script>
    document.getElementById("HeaderForm").addEventListener("submit", async function (e) {
          e.preventDefault();

          const form = document.getElementById("HeaderForm");
          const submitBtn = form.querySelector("button[type='submit']");
          const formData = new FormData(form);

          submitBtn.disabled = true;

          Swal.fire({
              title: 'Saving...',
              text: 'Please wait',
              allowOutsideClick: false,
              didOpen: () => Swal.showLoading()
          });

          try {
              const response = await fetch('/Header/Save', {
                  method: 'POST',
                  body: formData
              });

              if (!response.ok) {
                  throw new Error("Request failed");
              }

              const data = await response.json();

              if (data.success) {
                  Swal.fire({
                      icon: 'success',
                      title: 'Saved!',
                      text: data.message,
                      confirmButtonText: 'OK'
                  }).then((result) => {
                      if (result.isConfirmed) {
                          window.location.reload();
                      }
                  });
              } else {
                  Swal.fire({
                      icon: 'error',
                      title: 'Failed',
                      text: data.message
                  });
              }
          } catch (err) {
              Swal.fire({
                  icon: 'error',
                  title: 'Error',
                  text: 'Something went wrong while saving'
              });
              console.error(err);
          } finally {
              submitBtn.disabled = false;
          }
      });

</script>